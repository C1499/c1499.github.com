<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>jsp学生管理系统</title>
      <link href="/2019/05/18/jsp%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"/>
      <url>/2019/05/18/jsp%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p>这学期上了JSP课，虽然说这门技术已经落后了，但抱着“多学一点总没错”的心理还是学了这门课。期中的作业项目是做一个学生管理系统，本可以用spring写的，但是这是个小组作业嘛，总是要顾及一下同学的，毕竟她们还没学，而且也顺带巩固一下jsp，不然连作品都没有，白上半个学期的课了。回归正题，我就在这写一份教程，一是为了传播知识…（虽然不知道会不会有人看）二就是为了让自己以后能快速回顾，好记性不如烂笔头，三就是锻炼自己的写作能力，经常看到一些博主说，多写技术文档对自己是挺有益的。<br>首先我们先分析一个学生管理系统需要有什么功能。  </p><ul><li>登陆功能（login.jsp）</li><li>注册功能（register.jsp）</li><li>找回密码功能（forgotPWD.jsp + setPWD.jsp）</li><li>修改个人信息功能（updateUser.jsp）</li><li>查看所有学生功能（selectStudent.jsp）</li><li>添加学生信息功能（addStudent.jsp）</li><li>修改学生信息功能（updateStudent.jsp）</li><li>删除学生信息功能（delStudent.jsp）</li></ul><p>总的来说，基本就以上八种功能，这八种功能无非就是对数据的增删查改，也就是说我们只要能把登陆、注册、找回密码这三个功能做出来，后面那些简直 so easy ！我们先来想想登陆、注册页面需要些什么功能，首先是用户得要输入用户名和密码，一般网站登陆时都得输入验证码对吧，所以我们需要做一个验证码功能。接着是找回密码功能，这个功能就有点复杂，我们不可能说用户想随便找回密码就能找回吧，得确认用户的身份，身份确认的话，就在注册时让用户输入一个邮箱，用户找回密码的时候，就给当时用户注册时填写的邮箱发一封含有验证码的邮件，用户输入正确的验证码才能进行找回密码操作，这样就确定了用户的身份。一般我们都不会直接告诉用户旧密码是什么吧，所以就让用户直接设置新的密码即可。这就确定了两点，一是做一个验证码功能，二是邮件功能。开工吧！</p><p>我们先来连接数据库，这是一个重要的一步，数据库连接出错后面就全盘崩掉。</p><h2 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h2><p>首先，我们在Java Resources下的src目录下建一个包，包名为 com.db.tools ，接着再新建一个类，类名为 DbUtil 。这个类功能就是连接我们的数据库，并提供我们操作数据的方法。<br>这里我使用的是mysql数据库，去 mysql 的官网下载<a href="https://dev.mysql.com/downloads/connector/j/5.1.html" target="_blank" rel="noopener">驱动包</a>，我使用的是5.1.44版本。<br>把jar包拖到项目的 Java Resources–WebContent–WEB-INF–lib 下，接着右键 jar 包，找到 Build Path 单击 Add to Build Path 。这一步是把 jar 添加到项目的环境变量中，防止后续出现莫名的错误。<br><img src="https://test.demo-1s.com/images/2019/05/18/z5o7Xbm6MvE2DbNs.png" alt="jar加载path.png"><br>导入jar包后，我们就可以来连接数据库了。我的数据库中一共有两张表，一张是用户表，一张时学生信息表。字段名分别为：</p><p><code>tb_user:user_no(自增长)、user_number、user_name、user_sex、user_birthday、user_mail、user_pwdtb_student:stuNo、stu_name、stu_sex、stu_nativeplace、stu_birthday、stu_classname</code></p><p>数据库建好后，打开DbUtil类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.db.tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DbUtil</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义数据库连接类对象</span></span><br><span class="line"><span class="keyword">private</span> Connection conn = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义执行SQL查询语句的API对象</span></span><br><span class="line"><span class="keyword">private</span> PreparedStatement pstmt = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义存放结果集类的对象</span></span><br><span class="line"><span class="keyword">private</span> ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">DbUtil</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//加载mysql驱动</span></span><br><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//连接数据库，注意这里要把 database 改成自己的数据库名，root改成数据库的用户名，password 改成数据库的密码</span></span><br><span class="line">conn = DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/database?user=root&amp;password=password"</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询方法，返回类型为ResultSet</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ResultSet <span class="title">dbQuery</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//加载sql语句</span></span><br><span class="line">pstmt = conn.prepareStatement(sql);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//调用查询方法，把查询到的结果存放在rs中</span></span><br><span class="line">rs=pstmt.executeQuery();</span><br><span class="line"><span class="keyword">return</span> rs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//更新方法，返回类型为boolean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dbUpdate</span> <span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//加载sql语句</span></span><br><span class="line">pstmt = conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//调用更新方法，如果更新成功则返回true</span></span><br><span class="line"><span class="keyword">if</span>(pstmt.executeUpdate()&gt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上就是连接数据库，并对数据库进行查询和更改的方法。连接完了数据库我们就可以开始往后写了。接着实现验证码功能。</p><h2 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h2><p>我们在 com.db.tools 包中新建一个类，名为 CodeServlet 。<br>我们来想一想，验证码要怎么做。<br>首先，验证码肯定是随机的，不能按顺序，随机的话，那就是用到 java 的随机函数，Random 类，所以我们需要创建一个Random 对象得到一个随机数。随机数给它一个范围，所以我们就要建立一个数组存放我们需要的范围数，如（1，2，3，4，5，6，y，z，j），这样我们生成的数就只会是这些数内的，不可能出现 A，B，c 这些不在括号内的数。确定范围后，我们还需要确定我们的验证码需要几位字母，我想的是5位，不会太多不会太少，你可以根据你的想法定义。<br>接着，得到了一个随机的验证码之后，我们需要一个背景，不能让一些机器轻松的识别到，防止恶意登录注册，所以我们需要绘制生成一张色彩较为混乱的图片。再将验证码与图片混合。这样一张验证码图片就完成了。<br>讲完了思路，我们来实现。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.Color;</span><br><span class="line"><span class="keyword">import</span> java.awt.Font;</span><br><span class="line"><span class="keyword">import</span> java.awt.Graphics2D;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.catalina.Session;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.image.codec.jpeg.JPEGCodec;</span><br><span class="line"><span class="keyword">import</span> com.sun.image.codec.jpeg.JPEGImageEncoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CodeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span>[] chars=&#123;<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>,<span class="string">'X'</span>&#125;;<span class="comment">//验证码池</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Random random = <span class="keyword">new</span> Random();<span class="comment">//随机数</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String ranString;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getRandomString</span><span class="params">()</span></span>&#123; <span class="comment">//获取5位随机数，放在图片里</span></span><br><span class="line">StringBuffer buffer= <span class="keyword">new</span> StringBuffer();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">buffer.append(chars[random.nextInt(chars.length)]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> buffer.toString();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Color <span class="title">getRandomColor</span><span class="params">()</span></span>&#123;<span class="comment">//获取随机的颜色</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> Color(random.nextInt(<span class="number">255</span>),random.nextInt(<span class="number">255</span>),random.nextInt(<span class="number">255</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Color <span class="title">getReverseColor</span><span class="params">(Color c)</span></span>&#123; <span class="comment">//返回某颜色额反色</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> Color(<span class="number">255</span>-c.getRed(),<span class="number">255</span>-c.getGreen(),<span class="number">255</span>-c.getBlue());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CodeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line"><span class="keyword">super</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">super</span>.destroy();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">"image/jpeg"</span>);</span><br><span class="line">String randomString = getRandomString();</span><br><span class="line">request.getSession(<span class="keyword">true</span>).setAttribute(<span class="string">"randomString"</span>, randomString);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> width=<span class="number">80</span>;</span><br><span class="line"><span class="keyword">int</span> height=<span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">Color color = getRandomColor(); <span class="comment">//随机颜色，用于背景色</span></span><br><span class="line">Color reverse = getReverseColor(color); <span class="comment">//反色，用于前景色</span></span><br><span class="line"><span class="comment">//创建一个彩色图片</span></span><br><span class="line">BufferedImage bi = <span class="keyword">new</span> BufferedImage(width,height,BufferedImage.TYPE_INT_RGB);</span><br><span class="line">Graphics2D g = bi.createGraphics();</span><br><span class="line">g.setFont(<span class="keyword">new</span> Font(Font.SANS_SERIF,Font.BOLD,<span class="number">16</span>));</span><br><span class="line">g.setColor(color);</span><br><span class="line">g.fillRect(<span class="number">0</span>,<span class="number">0</span>,width,height);</span><br><span class="line">g.setColor(reverse);</span><br><span class="line">g.drawString(randomString, <span class="number">18</span>, <span class="number">20</span>);<span class="comment">//绘制随机字符</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,n=random.nextInt(<span class="number">100</span>);i&lt;n;i++)&#123;<span class="comment">//画最多100个噪音点</span></span><br><span class="line">            g.drawRect(random.nextInt(width), random.nextInt(height), <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">ServletOutputStream out= response.getOutputStream();<span class="comment">//转成JPEG格式</span></span><br><span class="line">        JPEGImageEncoder encoder=JPEGCodec.createJPEGEncoder(out);<span class="comment">//编码器</span></span><br><span class="line">        encoder.encode(bi);<span class="comment">//对图片进行编码</span></span><br><span class="line">        out.flush();<span class="comment">//输出到客户端</span></span><br><span class="line">        CodeServlet.ranString = randomString;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">sayRandom</span><span class="params">(String code)</span> </span>&#123;         <span class="comment">//判断是否生成的验证码一致</span></span><br><span class="line"><span class="keyword">if</span>(code.equalsIgnoreCase(ranString)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写完这些，我们打开 WebContent 下的 WEB-INF 文件夹下的 web.xml 文件，看看里面有没有：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CodeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.db.tools.CodeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CodeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/com.db.tools/CodeServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果没有，则把它添加至 “\<display-name>“ 标签的下方。接着在Java Resources–WebContent下新建一个 jsp 页面，在 body 标签下添加一个 img 标签。</display-name></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"com.mail/CodeServlet"</span> <span class="attr">id</span>=<span class="string">"identity"</span> <span class="attr">onclick</span>=<span class="string">"reloadImage()"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>接着在WebContent文件夹下新建一个名为 js 的文件夹，在里面建一个名为 code 的 js 文件，在里面添加下面的代码。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reloadImage</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'identity'</span>).src=<span class="string">'com.mail/CodeServlet?ts='</span>+<span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>回到 jsp 页面，引入 code.js 文件。运行一下 jsp 文件，看看页面上会不会出现一个验证码。接着单击验证码，验证码会更改。  </p><h2 id="邮件功能"><a href="#邮件功能" class="headerlink" title="邮件功能"></a>邮件功能</h2><p>发送邮件，就是一个邮箱向另一个邮箱发送邮件。所以我们得设定一个发送者的邮箱，接着得到用户的邮箱，编写好发送的内容进行发送。在这里里面不变的常量是发送者的邮箱，发送的内容格式，而会改变的就是用户的邮箱，验证码，所以我们定义两个变量存放用户邮箱和验证码。我使用的是qq邮箱的SMTP服务来发送邮件。接着，我们用代码实现，在Java Resources下的src目录下建一个包，包名为 com.mail ,接着在里面创建一个 Mail 类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.activation.DataHandler;</span><br><span class="line"><span class="keyword">import</span> javax.activation.DataSource;</span><br><span class="line"><span class="keyword">import</span> javax.activation.FileDataSource;</span><br><span class="line"><span class="keyword">import</span> javax.mail.*;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.InternetAddress;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeBodyPart;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMultipart;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mail</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> String result;</span><br><span class="line"><span class="keyword">private</span> String to;<span class="comment">//收件人邮箱</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTo</span><span class="params">(String to)</span> </span>&#123;<span class="comment">//设置收件人邮箱</span></span><br><span class="line"><span class="keyword">this</span>.to = to;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> String randomString;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getRandom</span><span class="params">()</span> </span>&#123;<span class="comment">//得到随机数</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.randomString;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span>[] chars=&#123;<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>,<span class="string">'X'</span>&#125;;<span class="comment">//验证码池</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Random random = <span class="keyword">new</span> Random();<span class="comment">//随机数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getRandomString</span><span class="params">()</span></span>&#123; <span class="comment">//获取5位随机数，放在图片里</span></span><br><span class="line">StringBuffer buffer= <span class="keyword">new</span> StringBuffer();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">buffer.append(chars[random.nextInt(chars.length)]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> buffer.toString();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Boolean <span class="title">sendCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 发件人的电子邮件名和密碼</span></span><br><span class="line">        String from = <span class="string">"发送者邮箱"</span>;</span><br><span class="line">        String psd = <span class="string">"qq开通SMTP服务后生成的密码"</span>;</span><br><span class="line">        <span class="comment">//设置用户名</span></span><br><span class="line">        String user = <span class="string">"发送者邮箱"</span>;</span><br><span class="line"></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 设置用户的认证方式</span></span><br><span class="line">            properties.setProperty( <span class="string">"mail.smtp.auth"</span>, <span class="string">"true"</span> );</span><br><span class="line">            <span class="comment">//设置传输协议</span></span><br><span class="line">            properties.setProperty( <span class="string">"mail.transport.protocol"</span>, <span class="string">"smtp"</span> );</span><br><span class="line">            <span class="comment">//SMTP邮件服务器</span></span><br><span class="line">            properties.setProperty( <span class="string">"mail.smtp.host"</span>, <span class="string">"smtp.qq.com"</span> );</span><br><span class="line">            <span class="comment">//SMTP邮件服务器默认端口</span></span><br><span class="line">            properties.setProperty( <span class="string">"mail.smtp.port"</span>, <span class="string">"587"</span> );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取默认的Session对象。</span></span><br><span class="line">            Session mailSession = Session.getDefaultInstance( properties );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建一个默认的MimeMessage对象。</span></span><br><span class="line">            Message message = <span class="keyword">new</span> MimeMessage( mailSession );</span><br><span class="line">            <span class="comment">// 根据session对象获取邮件传输对象Transport</span></span><br><span class="line">            Transport transport = mailSession.getTransport();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 设置 From: 头部的header字段</span></span><br><span class="line">            message.setFrom( <span class="keyword">new</span> InternetAddress( from ) );</span><br><span class="line">            <span class="comment">// 设置 To: 头部的header字段</span></span><br><span class="line">            message.addRecipient( Message.RecipientType.TO, <span class="keyword">new</span> InternetAddress( to ) );</span><br><span class="line">            <span class="comment">// 设置 Subject: header字段</span></span><br><span class="line">            message.setSubject( <span class="string">"邮件的标题"</span> );</span><br><span class="line">            <span class="comment">// 现在设置的实际消息</span></span><br><span class="line"></span><br><span class="line">            BodyPart messageBodyPart = <span class="keyword">new</span> MimeBodyPart();</span><br><span class="line">    randomString = getRandomString();<span class="comment">//获得随机验证码</span></span><br><span class="line">            messageBodyPart.setText(<span class="string">"您正在修改密码，请在验证码输入框中输入： "</span>+randomString+<span class="string">"，以完成操作。"</span>);</span><br><span class="line"></span><br><span class="line">            Multipart multipart = <span class="keyword">new</span> MimeMultipart();</span><br><span class="line"></span><br><span class="line">            multipart.addBodyPart(messageBodyPart);</span><br><span class="line">            <span class="comment">//发送文件</span></span><br><span class="line">            </span><br><span class="line">            message.setContent(multipart);</span><br><span class="line">            message.setSentDate(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 设置发件人的账户名和密码</span></span><br><span class="line">            transport.connect(user,psd);</span><br><span class="line">            <span class="comment">// 发送邮件，并发送到所有收件人地址，message.getAllRecipients() 获取到的是在创建邮件对象时添加的所有收件人, 抄送人, 密送人</span></span><br><span class="line">            transport.sendMessage( message, message.getAllRecipients() );</span><br><span class="line"></span><br><span class="line">            result = <span class="string">"Sent message fully...."</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            result = <span class="string">"Error: unable to send message...."</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">isCode</span><span class="params">(String code)</span> </span>&#123;<span class="comment">//判断是否与系统生成的验证码一致</span></span><br><span class="line">System.out.println(randomString);</span><br><span class="line">System.out.print(code);</span><br><span class="line"><span class="keyword">if</span>(code.equalsIgnoreCase(randomString)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用 setTo() 方法即可设置收件人邮箱，调用 isCode() 方法判断用户输入的验证码是否与发送的验证码一致。<br>当以上三个功能都做完后，我们就可以开始写页面功能了，我们先在 Java Resources–WebContent 文件夹下把上面提到的几个页面都建好，为下面做准备。<br>首先是注册页面，使用到的是增加。</p><h2 id="注册页面"><a href="#注册页面" class="headerlink" title="注册页面"></a>注册页面</h2><p>打开 register.jsp 文件，引入 code.js 接着建一个 form 表单。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">学号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"u_nub"</span> <span class="attr">id</span>=<span class="string">"u_nub"</span>&gt;</span></span><br><span class="line">    姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"u_name"</span> <span class="attr">id</span>=<span class="string">"u_name"</span>&gt;</span></span><br><span class="line">    邮箱：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"u_mail"</span> <span class="attr">id</span>=<span class="string">"u_mail"</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"u_pwd"</span> <span class="attr">id</span>=<span class="string">"u_pwd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">id</span>=<span class="string">"txtCode"</span> <span class="attr">name</span>=<span class="string">"txtCode"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"com.mail/CodeServlet"</span> <span class="attr">id</span>=<span class="string">"identity"</span> <span class="attr">onclick</span>=<span class="string">"reloadImage()"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span> <span class="attr">id</span>=<span class="string">"post"</span> <span class="attr">name</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>添加完表单后，我们用 js 写一个表单验证。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="keyword">var</span> ub = <span class="built_in">document</span>.getElementById(<span class="string">"u_nub"</span>),</span><br><span class="line">un = <span class="built_in">document</span>.getElementById(<span class="string">"u_name"</span>),</span><br><span class="line">um = <span class="built_in">document</span>.getElementById(<span class="string">"u_mail"</span>),</span><br><span class="line">upw = <span class="built_in">document</span>.getElementById(<span class="string">"u_pwd"</span>),</span><br><span class="line">    code = <span class="built_in">document</span>.getElementById(<span class="string">"txtCode"</span>),</span><br><span class="line">    post = <span class="built_in">document</span>.getElementById(<span class="string">"post"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">verify</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(ub.value == <span class="string">""</span>)&#123;</span><br><span class="line">alert(<span class="string">"请输入学号"</span>);</span><br><span class="line">ub.focus();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(un.value==<span class="string">""</span>)&#123;</span><br><span class="line">alert(<span class="string">"请输入姓名"</span>);</span><br><span class="line">un.focus();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(um.value==<span class="string">""</span>)&#123;</span><br><span class="line">alert(<span class="string">"请输入邮箱"</span>);</span><br><span class="line">um.focus();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(upw.value==<span class="string">""</span>)&#123;</span><br><span class="line">upw.focus();</span><br><span class="line">alert(<span class="string">"请输入密码"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(code.value==<span class="string">""</span>)&#123;</span><br><span class="line">code.focus();</span><br><span class="line">alert(<span class="string">"请输入验证码"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    post.onclick=verify();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>先运行一下程序，看看能否正常运行网页。<br><img src="https://test.demo-1s.com/images/2019/05/18/Rn4KubCrJEmvu7ie.png" alt="运行.png"></p><p>能正常运行，则可以继续往下写了，下面会用到我们之前写的java类，所以我们需要导包，在页面最上方 &lt;%@ page ……%&gt; 中，在最后添加一句“ import=”com.db.tools.<em>,java.sql.</em>“ ”。最终效果如下：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"com.db.tools.*,java.sql.*"</span>%&gt;</span><br></pre></td></tr></table></figure><p>这样我们的 jsp 页面才能找到我们的DbUtil类。继续往下。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="comment">//判断用户是否提交</span></span><br><span class="line"><span class="keyword">if</span>(request.getParameter(<span class="string">"post"</span>) != <span class="keyword">null</span>)&#123;</span><br><span class="line">        CodeServlet m = <span class="keyword">new</span> CodeServlet();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取前端页面数据</span></span><br><span class="line">        String code = request.getParameter(<span class="string">"txtCode"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(code != <span class="keyword">null</span> &amp;&amp; code != <span class="string">""</span>)&#123;</span><br><span class="line"><span class="comment">//判断验证码是否正确</span></span><br><span class="line"><span class="keyword">if</span>(m.sayRandom(code))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//获取前端页面数据</span></span><br><span class="line">                String uNub = request.getParameter(<span class="string">"u_nub"</span>);</span><br><span class="line">        String uName = request.getParameter(<span class="string">"u_name"</span>);</span><br><span class="line">        String uPwd = request.getParameter(<span class="string">"u_pwd"</span>);</span><br><span class="line">        String uMail = request.getParameter(<span class="string">"u_mail"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//创建DbUtil类对象</span></span><br><span class="line">                DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//创建变量存放sql语句</span></span><br><span class="line">                String sql = <span class="string">"select * from tb_user where user_number='"</span>+uNub+<span class="string">"'"</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果在数据库中能查询到当前注册用户的学生，则提示错误</span></span><br><span class="line">                <span class="keyword">if</span>(db.dbQuery(sql).next())&#123;</span><br><span class="line">                    out.println(<span class="string">"&lt;script&gt;alert('添加失败，此用户已存在');upw.value=\"\";upw.focus();&lt;/script&gt;"</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="comment">//在数据库中添加该用户</span></span><br><span class="line">                    sql = <span class="string">"insert into tb_user values('123',+'"</span>+uNub+<span class="string">"','"</span>+uName+<span class="string">"','"</span>+uMail+<span class="string">"','"</span>+uPwd+<span class="string">"')"</span>;</span><br><span class="line">                    <span class="keyword">if</span>(db.dbUpdate(sql))&#123;</span><br><span class="line">                        response.sendRedirect(<span class="string">"selectStudent.jsp"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;        </span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;script&gt;alert("验证码错误");&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>这样我们的注册页面就完成了，此时可以运行一下是否正常运行。</p><h2 id="登陆页面"><a href="#登陆页面" class="headerlink" title="登陆页面"></a>登陆页面</h2><p>打开 login.jsp ，引入 code.js 文件，接着写一个表单。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    学号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"u_nub"</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"u_pwd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">id</span>=<span class="string">"txtCode"</span> <span class="attr">name</span>=<span class="string">"txtCode"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"com.mail/CodeServlet"</span> <span class="attr">id</span>=<span class="string">"identity"</span> <span class="attr">onclick</span>=<span class="string">"reloadImage()"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"register.jsp"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"注册"</span> <span class="attr">name</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"forgotPWD.jsp"</span> <span class="attr">class</span>=<span class="string">"a"</span>&gt;</span>忘记密码？<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>接着还是用 js 写一个表单验证，我的建议是外链一个 js 文件，里面写一个函数，要用的时候直接调用，避免写重复的代码， input 标签里的 name 和 id 不同的页面但是是同一个数据的可以取相同名。例如注册页面的表单中有学号和密码，登陆页面也有，并且这两个含义相同，则可以取相同的 name 和 id ，这样直接一个函数就搞定了。<br>js 代码搞定后，就是jsp代码，首先像注册页面一样导包，这里也会用到验证码功能，所以依旧是导入 “ com.db.tools.<em>,java.sql.</em> ” 。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//判断用户是否提交</span></span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">"post"</span>) ！= <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="comment">//判断用户是否有输入学号</span></span><br><span class="line"><span class="keyword">if</span>(uName != <span class="keyword">null</span> &amp;&amp; uName != <span class="string">""</span> )&#123;</span><br><span class="line">            CodeServlet m = <span class="keyword">new</span> CodeServlet();</span><br><span class="line">    String code = request.getParameter(<span class="string">"txtCode"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取前端的学号</span></span><br><span class="line">    String uName = request.getParameter(<span class="string">"u_nub"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取前端的密码</span></span><br><span class="line">    String uPwd = request.getParameter(<span class="string">"u_pwd"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断用户是否有输入验证码</span></span><br><span class="line"><span class="keyword">if</span>(code != <span class="keyword">null</span> &amp;&amp; code != <span class="string">""</span>)&#123;</span><br><span class="line"><span class="comment">//判断用户输入的验证码是否正确</span></span><br><span class="line"><span class="keyword">if</span>(m.sayRandom(code))&#123;</span><br><span class="line"><span class="comment">//创建sql语句</span></span><br><span class="line">String sql = <span class="string">"select * from tb_user where user_number='"</span>+uName+<span class="string">"' and user_pwd='"</span>+uPwd+<span class="string">"'"</span>;</span><br><span class="line"><span class="comment">//创建DbUtil类对象 连接数据库</span></span><br><span class="line">DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line"><span class="comment">//创建ResultSet对象，存放结果集</span></span><br><span class="line">ResultSet rs = db.dbQuery(sql);</span><br><span class="line"><span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">session.setAttribute(<span class="string">"u_nub"</span>,uName);</span><br><span class="line">response.sendRedirect(<span class="string">"selectStudent.jsp"</span>);         <span class="comment">//跳转至查询学生信息界面</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">out.write(<span class="string">"登陆失败"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;script&gt;alert("验证码错误");&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>以上就是登陆页面的jsp代码，完成后尝试登陆一下，看看能否成功。</p><h2 id="找回密码页面"><a href="#找回密码页面" class="headerlink" title="找回密码页面"></a>找回密码页面</h2><p>找回密码呢，上面也说过，就是要确认用户的身份，是否为本人操作，这就需要验证码功能了。确定为本人后就跳转至设置密码页面，让用户重新设置密码。<br>打开 forgotPWD.jsp 页面，这里就不需要引入 code.js 了，这里需要用到邮箱功能，所以导入的包是“ com.mail,java.sql.<em>,com.db.tools.</em> ”，接着建一个表单。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">class</span>=<span class="string">"textbox"</span> <span class="attr">placeholder</span>=<span class="string">"请输入学号...."</span> <span class="attr">id</span>=<span class="string">"u_nub"</span> <span class="attr">name</span>=<span class="string">"u_nub"</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"textbox"</span> <span class="attr">placeholder</span>=<span class="string">"请输入邮箱...."</span> <span class="attr">id</span>=<span class="string">"u_mail"</span> <span class="attr">name</span>=<span class="string">"u_mail"</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"textcode"</span> <span class="attr">placeholder</span>=<span class="string">"请输入验证码...."</span> <span class="attr">id</span>=<span class="string">"txtCode"</span> <span class="attr">name</span>=<span class="string">"txtCode"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"textbutton"</span> <span class="attr">id</span>=<span class="string">"sendCode"</span> <span class="attr">name</span>=<span class="string">"sendCode"</span> &gt;</span>发送验证码<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"nextstep"</span> <span class="attr">value</span>=<span class="string">"下一步"</span> <span class="attr">name</span>=<span class="string">"next"</span> <span class="attr">id</span>=<span class="string">"next"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"login.jsp"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"register.jsp"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>开始写 jsp 代码。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个变量，存放验证码</span></span><br><span class="line">&lt;%!String mailCode; %&gt;</span><br><span class="line">&lt;%</span><br><span class="line"><span class="keyword">if</span>(request.getParameter(<span class="string">"sendCode"</span>) != <span class="keyword">null</span>)&#123;</span><br><span class="line">    String u_nub = request.getParameter(<span class="string">"u_nub"</span>);</span><br><span class="line">String u_mail = request.getParameter(<span class="string">"u_mail"</span>);</span><br><span class="line"><span class="keyword">if</span>(u_mail != <span class="keyword">null</span> &amp;&amp; u_mail !=<span class="string">""</span>)&#123;</span><br><span class="line">    DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line">        String sql = <span class="string">"select * from tb_user where user_number='"</span>+u_nub+<span class="string">"'and user_mail='"</span>+u_mail+<span class="string">"'"</span>; </span><br><span class="line"><span class="keyword">if</span>(db.dbQuery(sql).next())&#123;</span><br><span class="line">    Mail mail = <span class="keyword">new</span> Mail();</span><br><span class="line">mail.setTo(u_mail);</span><br><span class="line"><span class="keyword">if</span>(mail.sendCode())&#123;<span class="comment">//判断是否发送成功</span></span><br><span class="line">mailCode=mail.getRandom();</span><br><span class="line">%&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="keyword">var</span> num=document.getElementById(<span class="string">"u_nub"</span>);</span><br><span class="line">        <span class="keyword">var</span> mail=document.getElementById(<span class="string">"u_mail"</span>);</span><br><span class="line">        <span class="keyword">var</span> sendButton = document.getElementById(<span class="string">"sendCode"</span>);</span><br><span class="line">        <span class="function">function <span class="title">sendSuccess</span><span class="params">()</span></span>&#123;</span><br><span class="line">            alert(<span class="string">"发送成功"</span>);</span><br><span class="line">            sendButton.setAttribute(<span class="string">"disabled"</span>, <span class="keyword">true</span>);<span class="comment">//发送按钮不可用</span></span><br><span class="line">            zhi();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">function <span class="title">sendFailure</span><span class="params">()</span></span>&#123;</span><br><span class="line">            alert(<span class="string">"发送失败"</span>);</span><br><span class="line">            zhi();</span><br><span class="line">            &#125;</span><br><span class="line">            sendSuccess();</span><br><span class="line">            <span class="function">function <span class="title">zhi</span><span class="params">()</span></span>&#123;</span><br><span class="line">                num.value=<span class="string">"&lt;%=u_nub%&gt;"</span>;</span><br><span class="line">                mail.value=<span class="string">"&lt;%=u_mail%&gt;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">                                </span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">System.out.println(<span class="string">"邮箱："</span>+u_mail+<span class="string">"发送成功"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">System.out.println(<span class="string">"邮箱："</span>+u_mail+<span class="string">"发送失败"</span>);</span><br><span class="line">%&gt;</span><br><span class="line">    &lt;script&gt;sendFailure();&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">    &lt;script&gt;alert("用户不存在或邮箱错误");&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">"next"</span>) != <span class="keyword">null</span>)&#123;</span><br><span class="line">    String code = request.getParameter(<span class="string">"txtCode"</span>);</span><br><span class="line"><span class="keyword">if</span>(code != <span class="keyword">null</span> &amp;&amp; code != <span class="string">""</span> &amp;&amp; mailCode !=<span class="keyword">null</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(mailCode.equalsIgnoreCase(code))&#123;</span><br><span class="line">session.setAttribute(<span class="string">"u_number"</span>, u_nub);</span><br><span class="line">response.sendRedirect(<span class="string">"setPwd.jsp"</span>);<span class="comment">//验证码正确则跳转至设置密码页面</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">    &lt;script&gt;alert("验证码错误");&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>这就是找回密码页面啦，身份识别正确则跳转至 setPwd.jsp 页面。</p><h3 id="设置密码页面"><a href="#设置密码页面" class="headerlink" title="设置密码页面"></a>设置密码页面</h3><p>打开 setPwd.jsp 页面，同样的步骤，导包、建表单。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"textbox1"</span> <span class="attr">placeholder</span>=<span class="string">"请输入新密码...."</span> <span class="attr">name</span>=<span class="string">"u_pwd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"textbox1"</span> <span class="attr">placeholder</span>=<span class="string">"请再次输入新密码...."</span> <span class="attr">id</span>=<span class="string">"passwords"</span> <span class="attr">name</span>=<span class="string">"u_pwds"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"back1"</span> <span class="attr">value</span>=<span class="string">"确定"</span> <span class="attr">name</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"login.jsp"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"register.jsp"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>因为我们不能让用户随便就访问到这个页面，所以得设置一个拦截器，让不是从 forgotPWD.jsp 页面跳转过来，而是直接访问这个页面的用户自动跳转至 forgotPWD.jsp 页面。这里我使用的是 判断 session 的值是否为空的方法，因为forgotPWD.jsp 跳转时会将学号传到 setPwd.jsp 页面，这也算是一种思路吧。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;% </span><br><span class="line"><span class="keyword">if</span>(session.getAttribute(<span class="string">"u_number"</span>)==<span class="keyword">null</span>)&#123;</span><br><span class="line">response.sendRedirect(<span class="string">"login.jsp"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(request.getParameter(<span class="string">"post"</span>) != <span class="keyword">null</span>)&#123;</span><br><span class="line">String password=request.getParameter(<span class="string">"u_pwd"</span>),passwords=request.getParameter(<span class="string">"u_pwds"</span>);</span><br><span class="line"><span class="keyword">if</span>(password.equals(passwords) &amp;&amp; password != <span class="string">""</span> &amp;&amp; password != <span class="keyword">null</span>)&#123;</span><br><span class="line">String u_number = (String)session.getAttribute(<span class="string">"u_number"</span>);</span><br><span class="line">String sql = <span class="string">"Update tb_user set user_pwd = '"</span>+passwords+<span class="string">"' where user_number='"</span>+u_number+<span class="string">"'"</span>;</span><br><span class="line">DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line"><span class="keyword">if</span>(db.dbUpdate(sql))&#123;</span><br><span class="line">System.out.println(<span class="string">"修改成功"</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;script&gt;alert("修改成功");&lt;/scripot&gt;</span><br><span class="line">&lt;%</span><br><span class="line">response.sendRedirect(<span class="string">"login.jsp"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;script&gt;alert("两次密码输入不一致")&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>到这里，增删查改四个步骤已经实现了增加、查询、修改了，就剩下最后一个删除。后面的页面，我就放上代码，也不说太多了，毕竟大部分都是相同的，只是操作的表不同。</p><h2 id="删除学生页面"><a href="#删除学生页面" class="headerlink" title="删除学生页面"></a>删除学生页面</h2><p>其实，删除学生的页面是打不开的，里面只放了一段 jsp 代码。用户在 selectStudent.jsp 这个查看所有学生信息页面的操作一栏中，点击删除，即把那条学生信息的学号传给删除学生页面（delStudent.jsp）, delStudent.jsp 接收到学号，就在数据库中删除掉学生信息。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="keyword">if</span>(session.getAttribute(<span class="string">"u_nub"</span>) == <span class="keyword">null</span>)&#123;</span><br><span class="line">response.sendRedirect(<span class="string">"login.jsp"</span>); </span><br><span class="line">&#125;</span><br><span class="line">String stNo = request.getParameter(<span class="string">"st_no"</span>);</span><br><span class="line">String sql = <span class="string">"DELETE FROM tb_student WHERE stuNo='"</span>+stNo+<span class="string">"'"</span>;</span><br><span class="line">DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line"><span class="keyword">if</span>(db.dbUpdate(sql))&#123;</span><br><span class="line">response.sendRedirect(<span class="string">"selectStudent.jsp"</span>);</span><br><span class="line">out.println(<span class="string">"删除成功！"</span>);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>这也是十分简单了。</p><h2 id="修改个人信息页面"><a href="#修改个人信息页面" class="headerlink" title="修改个人信息页面"></a>修改个人信息页面</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">学号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"stuid"</span> <span class="attr">name</span>=<span class="string">"u_nub"</span> <span class="attr">id</span>=<span class="string">"u_nub"</span> <span class="attr">disabled</span>&gt;</span> 姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"stuid"</span> <span class="attr">name</span>=<span class="string">"u_name"</span> <span class="attr">id</span>=<span class="string">"u_name"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"stusex"</span>&gt;</span></span><br><span class="line">        性别：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"男"</span> <span class="attr">class</span>=<span class="string">"stusex1"</span> <span class="attr">id</span>=<span class="string">"sex1"</span>&gt;</span>&amp;nbsp;&amp;nbsp;男 &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">id</span>=<span class="string">"sex2"</span> <span class="attr">value</span>=<span class="string">"女"</span> <span class="attr">class</span>=<span class="string">"stusex1"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span>&amp;nbsp;&amp;nbsp;女</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">出生日期：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">class</span>=<span class="string">"stuage"</span> <span class="attr">name</span>=<span class="string">"u_bty"</span> <span class="attr">id</span>=<span class="string">"u_bty"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">邮箱：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"emails"</span> <span class="attr">name</span>=<span class="string">"u_mail"</span> <span class="attr">id</span>=<span class="string">"u_mail"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"personManages.jsp"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"重置"</span> <span class="attr">class</span>=<span class="string">"stubtu"</span> <span class="attr">name</span>=<span class="string">"reduction"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span> <span class="attr">class</span>=<span class="string">"stubtu"</span> <span class="attr">name</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    String uNum = (String)session.getAttribute(<span class="string">"u_nub"</span>);</span><br><span class="line">    <span class="keyword">if</span>(uNum != <span class="keyword">null</span>)&#123;       <span class="comment">//判断用户是否是已登陆状态</span></span><br><span class="line">        String uName;</span><br><span class="line">        String uSex;</span><br><span class="line">        String uBty;</span><br><span class="line">        String uMail;</span><br><span class="line">        String sql = <span class="string">" select * from tb_user where user_number='"</span>+uNum+<span class="string">"'"</span>;</span><br><span class="line">    DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line">        ResultSet rs=db.dbQuery(sql);</span><br><span class="line">        <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">            <span class="comment">//rs 1.id 2.学号 3.姓名 4.性别 5.生日 6.邮箱</span></span><br><span class="line">        uName = rs.getString(<span class="number">3</span>);</span><br><span class="line">        uSex = rs.getString(<span class="number">4</span>);</span><br><span class="line">        uBty = rs.getString(<span class="number">5</span>);</span><br><span class="line">        uMail = rs.getString(<span class="number">6</span>);</span><br><span class="line">        </span><br><span class="line">%&gt;</span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">            document.getElementById(<span class="string">"u_nub"</span>).value=<span class="string">"&lt;%=uNum%&gt;"</span>;</span><br><span class="line">            document.getElementById(<span class="string">"u_name"</span>).value=<span class="string">"&lt;%=uName%&gt;"</span>;</span><br><span class="line">            document.getElementById(<span class="string">"u_bty"</span>).value=<span class="string">"&lt;%=uBty%&gt;"</span>;</span><br><span class="line">            document.getElementById(<span class="string">"u_mail"</span>).value=<span class="string">"&lt;%=uMail%&gt;"</span>;</span><br><span class="line">            <span class="keyword">var</span> sex1 = document.getElementById(<span class="string">"sex1"</span>);</span><br><span class="line">            <span class="keyword">var</span> sex2 = document.getElementById(<span class="string">'sex2'</span>);</span><br><span class="line">            <span class="keyword">var</span> usex = <span class="string">"&lt;%=uSex%&gt;"</span>;</span><br><span class="line">            <span class="keyword">if</span>(usex == <span class="string">'女'</span>)&#123;</span><br><span class="line">                sex2.setAttribute(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                sex1.setAttribute(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(request.getParameter(<span class="string">"post"</span>) != <span class="keyword">null</span>)&#123;       <span class="comment">//判断用户是否点击提交按钮</span></span><br><span class="line">%&gt;</span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">            <span class="keyword">var</span> confirm = confirm(<span class="string">"确定修改吗？"</span>);</span><br><span class="line">            <span class="keyword">if</span>(confirm)&#123;</span><br><span class="line">&lt;%</span><br><span class="line">            String upSql = <span class="string">"update tb_user set user_name='"</span>+request.getParameter(<span class="string">"u_name"</span>)+<span class="string">"',user_sex='"</span>+request.getParameter(<span class="string">"sex"</span>)+<span class="string">"',user_mail='"</span>+request.getParameter(<span class="string">"u_mail"</span>)+<span class="string">"',user_birthday='"</span>+request.getParameter(<span class="string">"u_bty"</span>)+<span class="string">"' where user_number='"</span>+uNum+<span class="string">"'"</span>;</span><br><span class="line">            <span class="keyword">if</span>(db.dbUpdate(upSql))&#123;     <span class="comment">//判断是否更新成功</span></span><br><span class="line">%&gt;</span><br><span class="line">            alert(<span class="string">"修改成功"</span>);</span><br><span class="line">            window.location=<span class="string">"personManages.jsp"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">            alert(<span class="string">"修改失败"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        response.sendRedirect(<span class="string">"login.jsp"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">"outLogin"</span>) != <span class="keyword">null</span>)&#123;       <span class="comment">//退出登录按钮</span></span><br><span class="line">    session.invalidate();</span><br><span class="line">        response.sendRedirect(<span class="string">"login.jsp"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h2 id="查看学生信息页面"><a href="#查看学生信息页面" class="headerlink" title="查看学生信息页面"></a>查看学生信息页面</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(session.getAttribute(<span class="string">"u_nub"</span>) == <span class="keyword">null</span>)&#123;</span><br><span class="line">        response.sendRedirect(<span class="string">"login.jsp"</span>); </span><br><span class="line">    &#125;</span><br><span class="line">            String sql = <span class="string">" select * from tb_student"</span>;</span><br><span class="line">            DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line">            ResultSet rs=db.dbQuery(sql);</span><br><span class="line">%&gt;</span><br><span class="line">    &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line">&lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"th"</span>&gt;</span><br><span class="line">            &lt;td&gt;学号&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;性别&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;户籍&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;出生日期&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;班级&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;操作&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;tr name=<span class="string">"data"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"tr_bg"</span>&gt;</span><br><span class="line">&lt;td class="tr_id"&gt;&lt;%=rs.getString(1) %&gt;&lt;/td&gt;</span><br><span class="line">&lt;td class="tr_txt"&gt;&lt;%=rs.getString(2) %&gt;&lt;/td&gt;</span><br><span class="line">&lt;td class="tr_txt"&gt;&lt;%=rs.getString(3)%&gt;&lt;/td&gt;</span><br><span class="line">&lt;td class="tr_txt"&gt;&lt;%=rs.getString(4)%&gt;&lt;/td&gt;</span><br><span class="line">&lt;td class="tr_txt"&gt;&lt;%=rs.getString(5)%&gt;&lt;/td&gt;</span><br><span class="line">&lt;td class="tr_txt"&gt;&lt;%=rs.getString(6)%&gt;&lt;/td&gt;</span><br><span class="line">&lt;td <span class="class"><span class="keyword">class</span></span>=<span class="string">"tr_txt"</span>&gt;</span><br><span class="line">                &lt;a href="delete.jsp?st_no=&lt;%=rs.getString(1) %&gt;" onclick="return confirm('你确认要删除姓名为：&lt;%=rs.getString(2) %&gt;的数据吗？')"&gt;删除&lt;/a&gt;</span><br><span class="line">                &lt;a href="stuinfUpdate.jsp?stNo=&lt;%=rs.getString(1)%&gt;"&gt;修改&lt;/a&gt;</span><br><span class="line">                &lt;a href="addStudent.jsp"&gt;添加学生&lt;/a&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">    &lt;/table&gt;</span><br></pre></td></tr></table></figure><h2 id="添加学生信息页面"><a href="#添加学生信息页面" class="headerlink" title="添加学生信息页面"></a>添加学生信息页面</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">学号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_No"</span> <span class="attr">id</span>=<span class="string">"st_No"</span>&gt;</span></span><br><span class="line">姓名： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_name"</span> <span class="attr">id</span>=<span class="string">"st_name"</span>&gt;</span></span><br><span class="line">性别： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"男"</span> <span class="attr">class</span>=<span class="string">"stuformsex"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span>&amp;nbsp;&amp;nbsp;男&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"女"</span> <span class="attr">class</span>=<span class="string">"stuformsex"</span>&gt;</span>&amp;nbsp;&amp;nbsp;女</span><br><span class="line">出生日期： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span><span class="attr">name</span>=<span class="string">"st_bty"</span> <span class="attr">id</span>=<span class="string">"st_bty"</span>&gt;</span></span><br><span class="line">户籍： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_Place"</span> <span class="attr">id</span>=<span class="string">"st_Place"</span>&gt;</span></span><br><span class="line">班级： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_claName"</span> <span class="attr">id</span>=<span class="string">"st_claName"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"stuformbut"</span> <span class="attr">onclick</span>=<span class="string">"return verify();"</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"stuformbut"</span> <span class="attr">onclick</span>=<span class="string">"javascript:window.location.href='selectStudent.jsp'"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="keyword">if</span>(session.getAttribute(<span class="string">"u_nub"</span>) == <span class="keyword">null</span>)&#123;</span><br><span class="line"> response.sendRedirect(<span class="string">"login.jsp"</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(request.getParameter(<span class="string">"st_No"</span>) != <span class="keyword">null</span> &amp;&amp; request.getParameter(<span class="string">"st_No"</span>) != <span class="string">""</span>)&#123;</span><br><span class="line">String stNo = request.getParameter(<span class="string">"st_No"</span>);</span><br><span class="line">String stName = request.getParameter(<span class="string">"st_name"</span>);</span><br><span class="line">String stSex = request.getParameter(<span class="string">"sex"</span>);</span><br><span class="line">String stPlac = request.getParameter(<span class="string">"st_Place"</span>);</span><br><span class="line">String stByt = request.getParameter(<span class="string">"st_bty"</span>);</span><br><span class="line">String stClna = request.getParameter(<span class="string">"st_claName"</span>);</span><br><span class="line">DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line">String sql = <span class="string">"select * from tb_student where stuNo='"</span>+stNo+<span class="string">"'"</span>;</span><br><span class="line"><span class="keyword">if</span>(db.dbQuery(sql).next())&#123;</span><br><span class="line">out.println(<span class="string">"&lt;script&gt;alert('添加失败，学号已存在');&lt;/script&gt;"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">sql = <span class="string">"insert into tb_student values('"</span>+stNo+<span class="string">"','"</span>+stName+<span class="string">"','"</span>+stSex+<span class="string">"','"</span>+stPlac+<span class="string">"','"</span>+stByt+<span class="string">"','"</span>+stClna+<span class="string">"')"</span>;</span><br><span class="line"><span class="keyword">if</span>(db.dbUpdate(sql))&#123;</span><br><span class="line">response.sendRedirect(<span class="string">"stuinFormation.jsp"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h2 id="修改学生信息页面"><a href="#修改学生信息页面" class="headerlink" title="修改学生信息页面"></a>修改学生信息页面</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">学号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_No"</span> <span class="attr">id</span>=<span class="string">"st_No"</span>&gt;</span></span><br><span class="line">姓名： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_name"</span> <span class="attr">id</span>=<span class="string">"st_name"</span>&gt;</span></span><br><span class="line">性别： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"男"</span> <span class="attr">class</span>=<span class="string">"stuformsex"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span>&amp;nbsp;&amp;nbsp;男&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"女"</span> <span class="attr">class</span>=<span class="string">"stuformsex"</span>&gt;</span>&amp;nbsp;&amp;nbsp;女</span><br><span class="line">出生日期： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span><span class="attr">name</span>=<span class="string">"st_bty"</span> <span class="attr">id</span>=<span class="string">"st_bty"</span>&gt;</span></span><br><span class="line">户籍： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_Place"</span> <span class="attr">id</span>=<span class="string">"st_Place"</span>&gt;</span></span><br><span class="line">班级： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"st_claName"</span> <span class="attr">id</span>=<span class="string">"st_claName"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"stuformbut"</span> <span class="attr">onclick</span>=<span class="string">"return verify();"</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"stuformbut"</span> <span class="attr">onclick</span>=<span class="string">"javascript:window.location.href='selectStudent.jsp'"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">String stNo = (String)session.getAttribute(<span class="string">"stNo"</span>);</span><br><span class="line">DbUtil db = <span class="keyword">new</span> DbUtil();</span><br><span class="line"><span class="keyword">if</span>(session.getAttribute(<span class="string">"u_nub"</span>) == <span class="keyword">null</span>)&#123;</span><br><span class="line">response.sendRedirect(<span class="string">"login.jsp"</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(request.getParameter(<span class="string">"stNo"</span>) != <span class="keyword">null</span>)&#123;</span><br><span class="line">stNo = request.getParameter(<span class="string">"stNo"</span>);</span><br><span class="line">session.setAttribute(<span class="string">"stNo"</span>, stNo);</span><br><span class="line">String sql = <span class="string">"select * from tb_student where stuNo='"</span>+stNo+<span class="string">"'"</span>;</span><br><span class="line">ResultSet rs = db.dbQuery(sql);</span><br><span class="line"><span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">document.getElementById(<span class="string">"st_No"</span>).value=<span class="string">"&lt;%=rs.getString(1)%&gt;"</span>;</span><br><span class="line">document.getElementById(<span class="string">"st_name"</span>).value=<span class="string">"&lt;%=rs.getString(2)%&gt;"</span>;</span><br><span class="line"><span class="keyword">var</span> usex = <span class="string">"&lt;%=rs.getString(3)%&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(usex == <span class="string">'女'</span>)&#123;</span><br><span class="line">sex2.setAttribute(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">sex1.setAttribute(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(<span class="string">"st_Place"</span>).value=<span class="string">"&lt;%=rs.getString(4)%&gt;"</span>;</span><br><span class="line">document.getElementById(<span class="string">"st_bty"</span>).value=<span class="string">"&lt;%=rs.getString(5)%&gt;"</span>;</span><br><span class="line">document.getElementById(<span class="string">"st_claName"</span>).value=<span class="string">"&lt;%=rs.getString(6)%&gt;"</span>;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(request.getParameter(<span class="string">"post"</span>)!=<span class="keyword">null</span> &amp;&amp; stNo != <span class="keyword">null</span>)&#123;</span><br><span class="line">        String sql = <span class="string">"update tb_student set stu_Name='"</span>+request.getParameter(<span class="string">"st_name"</span>)+<span class="string">"',stu_sex='"</span>+request.getParameter(<span class="string">"st_sex"</span>)+<span class="string">"',stu_nativeplace='"</span>+request.getParameter(<span class="string">"st_Place"</span>)+<span class="string">"',stu_birthday='"</span>+request.getParameter(<span class="string">"st_bty"</span>)+<span class="string">"',stu_classname='"</span>+request.getParameter(<span class="string">"st_claName"</span>)+<span class="string">"' where stuNo='"</span>+stNo+<span class="string">"'"</span>;</span><br><span class="line">        <span class="keyword">if</span>(db.dbUpdate(sql))&#123;</span><br><span class="line">        response.sendRedirect(<span class="string">"stuinfManages.jsp"</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;script type="text/javascript"&gt;alert("修改成功");&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;script type="text/javascript"&gt;alert("修改失败");&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><p>至此，差不多整个项目的雏形已经出来了，就是差一个页面的美化。不知不觉写了这么多，到后面其实已经有点累了，一度想着要不算了，反正都是重复的，还好没有放弃，还是把所有的页面代码贴了出来，尽管没有刚开始写的那么详细，但是我相信前面要是认认真真看了的，后面的肯定也会理解的。这个项目就告一段落啦，后面还想着会用 spring 重写一遍，在这里立一个 flag 。</p>]]></content>
      
      
      <categories>
          
          <category> JSP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSP </tag>
            
            <tag> 作业项目 </tag>
            
            <tag> 2019 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2019/01/15/hello-world/"/>
      <url>/2019/01/15/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate$ hexo generate$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate$ hexo generatehighlighthighlighthighlighthighlighthighlighthighlighthighlighthighlighthighlighthighlighthighlighthighlighthighlight</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
